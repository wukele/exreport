

<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html"; charset="gb2312">
		<title>大数据量压缩数据报表</title>
		<script type="text/javascript" src="excel.js"></script>
		<script type="text/javascript">
  
  //所有数据的bean
  	var bean = {
  	"EXCEL_DATA_LENGTH":5000,
"HIDDEN_FIELDS":"lastmonth,lastyear",
"zipfilepath":"D:\\study\\java\\exreport\\trunk\\exreport\\release\\2.zip",
"unzipfolder":"D:\\study\\java\\exreport\\trunk\\exreport\\release\\2unzip\\",
"DTO_DATA_ARRAYS":[
],
"META_DATA_ARRAYS":[
"EXCEL_DATA_LENGTH",
"HIDDEN_FIELDS",
"zipfilepath",
"unzipfolder",
"industry",
"owner",
"unit",
"REPORT_DTO_FIELDS_KEY",
"date",
"area",
"number"
],
"industry":"金融",
"owner":"国有",
"unit":"万元",
"REPORT_DTO_FIELDS_KEY":"code,name,area,sum,lastmonth,lastyear,term",
"date":"2008-6-20 4:52:33",
"area":"beijing",
"number":111111111


  };
 
  var isdowndata = false;  //是否是下载数据文件方式
 	var reportdatazip = true; //是否是zip格式数据
 	
  var colsname = 'code,name,area,sum,lastmonth,lastyear,term'; // 需要处理的列名
  var serverurl ='http://localhost:8080';//服务器端ip
  //var serverport = '8080';   //端口
  var contextpath = '/exreport/xls'; //模板路径
  var templatename = 'report1';     //模板名称
  var extensename = '.xls';			//模板文件扩展名
  //var downservlet = "/naf/xls/5w.zip"; //数据文件路径
  //var downservlet = "/naf/ReportDataServlet?rows=50000&cols=" + colsname;
  
  var fileid = ""; //文件名附加字符串，可用于判断是否需要重新下载
  
  var reporttype = 1; // 报表类型, 0普通, 1 交叉表 
    
     
      function   document.onkeydown(){   
         if( window.event.ctrlKey && window.event.shiftKey && window.event.keyCode==39)
			{
				executeMacro("hidecols");
			}
		 else if( window.event.ctrlKey && window.event.shiftKey && window.event.keyCode==37)
			{
				executeMacro("showcols");
			}
  }
  </script>

		<script language="vbscript" src="array.vbs"></script>


	</head>

	<body>
		<input type="button" value="保存报表" name="save"
			onclick="save('c:\\abcd.xls')">
			
		<input type="button" value="导出报表" name="export" class="BUTTON"
			onclick="output()">
		<input type="button" value="打印报表" name="print" class="BUTTON"
			onclick="print()">
		<input type="button" value="打印预览" name="preview" class="BUTTON"
			onclick="preview()">
		<input type="button" value="报表转置" name="revers" class="BUTTON"
			onclick="revers()">
		<input type="button" value="报表放大" name="zoomin" class="BUTTON"
			onclick="zoomin()">
		<input type="button" value="报表缩小" name="zoomout" class="BUTTON"
			onclick="zoomout()">
		<input type="button" value=" 关  闭 " name="wclose" class="BUTTON"
			onclick="window.close();">

		<object classid="clsid:00460182-9E5E-11d5-B7C8-B8269041DD57"
			id="oframe" width="100%" height="100%">
			<PARAM NAME="_ExtentX" VALUE="23283">
			<PARAM NAME="_ExtentX" VALUE="23283">
			<PARAM NAME="_ExtentY" VALUE="13891">
			<PARAM NAME="BorderColor" VALUE="-2147483632">
			<PARAM NAME="BackColor" VALUE="-2147483643">
			<PARAM NAME="ForeColor" VALUE="-2147483640">
			<PARAM NAME="TitlebarColor" VALUE="-2147483635">
			<PARAM NAME="TitlebarTextColor" VALUE="-2147483634">
			<PARAM NAME="BorderStyle" VALUE="1">
			<PARAM NAME="Titlebar" VALUE="0">
			<PARAM NAME="Toolbars" VALUE="0">
			<PARAM NAME="Menubar" VALUE="0">
		</OBJECT>
	</body>
	<script type="text/javascript">
	  
	   var localfolder = "D:\\study\\java\\exreport\\trunk\\exreport\\release\\"; //你需要把这个路径改为你实际的绝对路径。不可使用相对路径。
	   var tmfile = localfolder + "report2.xls"; //下载模板
	  
	  window.setTimeout('createReport(tmfile);',500); //创建报表
	  
  </script>
</html>

